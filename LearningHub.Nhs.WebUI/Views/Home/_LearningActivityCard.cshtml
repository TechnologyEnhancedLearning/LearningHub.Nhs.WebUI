@using LearningHub.Nhs.Models.Dashboard
@using LearningHub.Nhs.Models.Provider
@using LearningHub.Nhs.Models.MyLearning;
@using LearningHub.Nhs.Models.Enums
@using LearningHub.Nhs.WebUI.Extensions
@using LearningHub.Nhs.WebUI.Models
@using System.Linq
@using System.Collections.Generic;
@using LearningHub.Nhs.WebUI.Helpers
@inject LearningHub.Nhs.WebUI.Interfaces.IMoodleApiService moodleApiService;
@model Tuple<string, MyLearningCombinedActivitiesViewModel>
@{
    string cardStyle = Model.Item1.Contains("my-learning") ? "card-provider-details--darkblank" : "card-provider-details--blank";
    var activityDate = Model.Item2.ActivityDate.Date;
    var today = DateTime.Today;
    var dateTimeText = activityDate == today ? "Today"
    : activityDate == today.AddDays(-1) ? "Yesterday"
    : activityDate.ToString("dd MMM yyyy");
    string GetMoodleCourseUrl(int courseId)
    {
        return moodleApiService.GetCourseUrl(courseId);
    }
}
<div class="nhsuk-card dashboard-card">
    <div class="nhsuk-card__content dashboard-card-content">
        <div>
            <h3 class="nhsuk-card__heading nhsuk-heading-m line-clamp-2">

                @if (ViewActivityHelper.GetResourceTypeDesc(Model.Item2.ResourceType) == "Course")
                {
                    <a class="nhsuk-u-font-size-19 nhsuk-card__link" href="@GetMoodleCourseUrl(Model.Item2.ResourceId)">@Model.Item2.Title</a>
                }
                else
                {
                    <a class="nhsuk-u-font-size-19 nhsuk-card__link" asp-controller="Resource" asp-action="Index" asp-route-resourceReferenceId="@Model.Item2.ResourceReferenceId">@Model.Item2.Title</a>
                }
            </h3>
        </div>
        <div class="nhsuk-card__description dashboard-card-body">


            <div class="nhs-item-row nhsuk-u-padding-bottom-3 nhsuk-u-padding-top-2">
                <div>
                    <span class="nhsuk-u-secondary-text-color nhsuk-u-font-size-16 nhsuk-u-font-weight-bold nhsuk-u-padding-right-2">Type:</span>

                    <span class="nhsuk-u-padding-right-3  nhsuk-u-font-size-16 nhsuk-u-secondary-text-color">
                        @ViewActivityHelper.GetResourceTypeDesc(Model.Item2.ResourceType)
                    </span>
                </div>
                <div>
                    <span class="nhsuk-u-text-align-left  table-content-spacing">
                        <strong class="nhsuk-tag nhsuk-tag--blue">
                            In progress
                        </strong>
                    </span>
                </div>
            </div>
            <div class="nhsuk-u-padding-bottom-3">
                <span class="nhsuk-u-padding-right-2 nhsuk-u-font-size-16 nhsuk-u-secondary-text-color nhsuk-u-font-weight-bold">
                    Accessed:
                </span>

                <span class="nhsuk-u-font-size-16 nhsuk-u-secondary-text-color">
                    @dateTimeText
                </span>
            </div>
            @if (ViewActivityHelper.GetResourceTypeDesc(Model.Item2.ResourceType) == "Course")
            {
                <div class="nhs-progress-container" role="progressbar" aria-valuemin="0" aria-valuemax="100">
                    <div class="nhs-progress-bar" style="width: @(Model.Item2.ScorePercentage)%"></div>
                </div>
            }
            <div class="nhsuk-u-padding-bottom-5 nhsuk-u-padding-top-4">
                @if (ViewActivityHelper.GetResourceTypeDesc(Model.Item2.ResourceType) == "Course")
                {
                    <div class="nhsuk-u-font-size-16 nhsuk-u-font-weight-bold nhsuk-u-secondary-text-color" id="progressText"> @Model.Item2.CompletedActivities of @Model.Item2.TotalActivities activities completed</div>
                }
                else
                {
                    <div>
                        <span class="nhsuk-u-visually-hidden">No certificate available</span>
                    </div>
                }
            </div>
            <div>
                @if (Model.Item2.CertificateEnabled == true)
                {
                    <div class="nhsuk nhsuk-u-font-size-16 nhsuk-u-secondary-text-color">
                        Includes a certificate
                        <span class="nhsuk-u-padding-left-1">
                            <svg xmlns="http://www.w3.org/2000/svg" width="19" height="24" viewBox="0 0 19 24" fill="none">
                                <g clip-path="url(#clip0_1298_21764)">
                                    <path d="M13.7817 18.9737V23.1883C13.7817 23.4148 13.1731 23.5225 12.8452 23.3543L9.9952 21.8784C9.77736 21.7662 9.39332 21.7685 9.18221 21.8851L6.60399 23.3139C6.28284 23.4911 5.65625 23.3879 5.65625 23.1546V17.6055" stroke="#AEB7BD" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="M18.4565 9.08368C18.4565 9.70947 17.3246 10.2007 17.1898 10.7884C17.0551 11.376 17.8568 12.327 17.5918 12.8721C17.3268 13.4171 16.0894 13.379 15.7076 13.8568C15.3258 14.3345 15.6447 15.5255 15.1641 15.9091C14.6835 16.2927 13.5965 15.714 13.0395 15.9831C12.4826 16.2523 12.2647 17.459 11.6583 17.5958C11.052 17.7327 10.34 16.739 9.71344 16.739C9.08685 16.739 8.35471 17.7304 7.76855 17.5958C7.18239 17.4613 6.93535 16.2456 6.38736 15.9831C5.83938 15.7207 4.74117 16.2904 4.2628 15.9091C3.78444 15.5278 4.10335 14.3368 3.71931 13.8568C3.33527 13.3768 2.10456 13.4284 1.8373 12.8721C1.57005 12.3158 2.3763 11.394 2.23931 10.7884C2.10231 10.1827 0.972656 9.71172 0.972656 9.08368C0.972656 8.45564 2.10456 7.96667 2.23931 7.37901C2.37406 6.79134 1.57229 5.84032 1.8373 5.29527C2.10231 4.75022 3.33977 4.78835 3.72156 4.3106C4.10335 3.83284 3.78444 2.64181 4.26505 2.25826C4.74566 1.87471 5.83264 2.4534 6.38961 2.18424C6.94658 1.91508 7.16442 0.708352 7.7708 0.57153C8.37717 0.434707 9.0891 1.42835 9.71569 1.42835C10.3423 1.42835 11.0744 0.43695 11.6606 0.57153C12.2467 0.706109 12.4938 1.92181 13.0418 2.18424C13.5898 2.44667 14.688 1.87695 15.1663 2.25826C15.6447 2.63957 15.3258 3.8306 15.7098 4.3106C16.0939 4.7906 17.3246 4.73901 17.5918 5.29527C17.8591 5.85153 17.0528 6.7734 17.1898 7.37901C17.3268 7.98461 18.4565 8.45564 18.4565 9.08368Z" fill="#F2F8FD" />
                                    <path d="M18.4565 9.08368C18.4565 9.70947 17.3246 10.2007 17.1898 10.7884C17.0551 11.376 17.8568 12.327 17.5918 12.8721C17.3268 13.4171 16.0894 13.379 15.7076 13.8568C15.3258 14.3345 15.6447 15.5255 15.1641 15.9091C14.6835 16.2927 13.5965 15.714 13.0395 15.9831C12.4826 16.2523 12.2647 17.459 11.6583 17.5958C11.052 17.7327 10.34 16.739 9.71344 16.739C9.08686 16.739 8.35471 17.7304 7.76855 17.5958C7.18239 17.4612 6.93535 16.2455 6.38736 15.9831C5.83938 15.7207 4.74117 16.2904 4.2628 15.9091C3.78444 15.5278 4.10335 14.3368 3.71931 13.8568C3.33527 13.3768 2.10456 13.4284 1.8373 12.8721C1.57005 12.3158 2.3763 11.394 2.23931 10.7884C2.10231 10.1827 0.972656 9.71172 0.972656 9.08368C0.972656 8.45564 2.10456 7.96667 2.23931 7.37901C2.37406 6.79134 1.57229 5.84032 1.8373 5.29527C2.10231 4.75022 3.33977 4.78835 3.72156 4.3106C4.10335 3.83284 3.78444 2.64181 4.26505 2.25826C4.74566 1.87471 5.83264 2.4534 6.38961 2.18424C6.94658 1.91508 7.16442 0.708352 7.7708 0.57153C8.37717 0.434707 9.0891 1.42835 9.71569 1.42835C10.3423 1.42835 11.0744 0.43695 11.6606 0.57153C12.2467 0.706109 12.4938 1.92181 13.0418 2.18424C13.5898 2.44667 14.688 1.87695 15.1663 2.25826C15.6447 2.63957 15.3258 3.8306 15.7098 4.3106C16.0939 4.7906 17.3246 4.73901 17.5918 5.29527C17.8591 5.85153 17.0528 6.7734 17.1898 7.37901C17.3268 7.98461 18.4565 8.45564 18.4565 9.08368Z" stroke="#AEB7BD" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="M9.64784 13.2915L5.35156 8.03622L7.21336 5.27734H12.3698L14.0901 8.03622L9.64784 13.2915Z" fill="#F2F8FD" stroke="#AEB7BD" stroke-width="0.9" stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="M9.68893 13.2915L7.71484 8.03622L8.57051 5.27734H10.9376L11.7259 8.03622L9.68893 13.2915Z" fill="#F2F8FD" stroke="#AEB7BD" stroke-width="0.9" stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="M5.53516 7.99609H12.5556" stroke="#AEB7BD" stroke-width="0.9" stroke-linecap="round" stroke-linejoin="round" />
                                </g>
                                <defs>
                                    <clipPath id="clip0_1298_21764">
                                        <rect width="18.5764" height="24" fill="white" transform="translate(0.421875)" />
                                    </clipPath>
                                </defs>
                            </svg>
                        </span>
                    </div>
                }
            </div>
        </div>
    </div>
    @* <div class="card-provider-details @cardStyle"></div> *@
</div>